      <!-- Order items akan ditampilkan di sini -->
      <div class="empty-order-message">No items added to order</div>
    </div>

    <div class="order-actions">
      <div class="order-total">
        <span>Total:</span>
        <span id="order-total-amount">₹0.00</span>
      </div>

      <div class="action-buttons">
        <!-- Tombol-tombol untuk aksi order -->
        <button id="send-to-kitchen-btn" class="action-btn btn-kitchen disabled-btn">Send to Kitchen</button>
        <button id="send-additional-btn" class="action-btn btn-additional disabled-btn">Send Additional Items</button>
      </div>
    </div>
  </div>
</div>

<!-- (Modal Modal dan overlay tetap seperti sebelumnya) -->

<script>
  // Data context dari server
  window.waiterOrderData = {
    csrfToken: "{{ frappe.session.csrf_token }}"
  };

  /* Contoh pseudocode JavaScript (di file waiter_order.js atau inline script)
  
  1. Saat halaman load, lakukan fetch data daftar meja.
     - Filter meja berdasarkan status:
         * "editing": meja dengan order yang sedang diedit
         * "available": meja yang available untuk order baru
  2. Render tombol meja dengan data-status (misal: data-status="editing" atau "available")
     - Jika status "editing", tombol boleh diklik untuk mengedit order.
     - Jika status "available", tombol bisa men-trigger notifikasi "use New Order button" atau langsung memilihnya.
  3. Event listener untuk tombol "New Order":
     - Saat ditekan, baca input field #new-order-table-number.
     - Cek melalui database (atau validasi di front-end) apakah meja dengan nomor tersebut berstatus "available".
     - Jika available, buat order baru dan update tampilan "selected-table-display".
     - Jika tidak, beri peringatan bahwa meja tidak available.
  
  Contoh kode sederhana (tidak lengkap):
  
  document.getElementById("new-order-btn").addEventListener("click", function(){
    let tableNo = document.getElementById("new-order-table-number").value.trim();
    if(!tableNo){
      alert("Please enter a table number");
      return;
    }
    // Misalnya, cek status meja melalui fungsi cekStatusMeja(tableNo)
    if(cekStatusMeja(tableNo) !== "available"){
      alert("Table is not available for new order");
      return;
    }
    // Jika available, set selected table dan buat order baru
    document.getElementById("selected-table-display").innerText = "Table " + tableNo;
    // Lanjutkan logika untuk create new order...
  });
  
  */
</script>
{% endblock %}

{% block script %}
<script src="/assets/restaurant_management/js/waiter_order.js"></script>
{% endblock %}
Penjelasan Perubahan:
Bagian New Order Section:
Ditambahkan div dengan kelas new-order-section di atas grid tabel untuk memasukkan nomor meja baru dan tombol "New Order".
Pengguna dapat memasukkan nomor meja secara manual dan klik tombol tersebut.

Modifikasi Daftar Meja:
Di bagian <div class="tables-grid" id="tables-container"> kamu dapat memodifikasi JavaScript (pada file waiter_order.js) sehingga hanya memuat meja yang statusnya "editing" (untuk order yang sudah aktif) atau "available" (untuk membuat order baru).
Tombol meja yang tidak available (misalnya sedang dipakai) bisa diberi kelas occupied atau dinonaktifkan.

Logika Validasi:
Pada event listener tombol "New Order", lakukan validasi agar hanya dapat membuat order baru jika status meja "available".
Jika tidak available, tampilkan notifikasi/pesan error.

Modifikasi kode JavaScript (pada file waiter_order.js) perlu disesuaikan untuk:

Fetch status meja dari server.

Filter dan render tombol meja dengan data-status yang benar.

Menangani event klik pada tombol meja untuk edit order maupun tombol "New Order".

Kamu bisa mengadaptasi contoh pseudocode di atas ke dalam implementasi sesuai dengan struktur data kamu.
Apakah penjelasan dan contoh kode ini sudah sesuai dengan yang kamu maksud? Jika perlu penyesuaian lebih lanjut atau contoh implementasi JavaScript lebih rinci, silakan kabari!






You said:
waiter_order.js
JavaScript
mohon sesuai kan dan rewrite ulang


ChatGPT said:
Reasoned about waiter order management logic for 43 seconds
Berikut saya lampirkan versi terintegrasi dari file HTML dan JS yang sudah saya modifikasi sesuai permintaan. Modifikasi utama yaitu:

Di tampilan (HTML):

Di bagian table selection, ditambahkan “New Order Section” dengan input nomor meja dan tombol “New Order”.

Tampilan grid tabel hanya menampilkan meja yang sedang aktif (yaitu meja dengan order aktif) untuk diedit.

Di logic JavaScript (waiter_order.js):

Fungsi renderTables diubah sehingga hanya menampilkan tabel dengan order aktif (misalnya, properti current_pos_order ada).

Ditambahkan event listener untuk tombol “New Order”. Saat tombol ditekan, script akan membaca nilai input nomor meja, mencari data meja (berdasarkan properti table_number atau name), dan memeriksa apakah meja tersebut tersedia (tidak ada order aktif). Jika tersedia, maka meja tersebut akan dipilih dan (secara simulasi) ditandai dengan order baru; jika tidak tersedia, maka akan tampil pesan error.

Di bawah ini saya tampilkan contohnya:

File: waiter_order.html
html
Copy
{% extends "templates/web.html" %}

{% block title %}Waiter Order Interface{% endblock %}

{% block style %}
<style>
  /* Layout utama */
  .waiter-order-container {
    display: flex;
    margin: 0 -15px;
  }
  .left-column {
    flex: 2;
    padding: 0 15px;
    display: flex;
    flex-direction: column;
    min-height: 80vh;
  }
  .right-column {
    flex: 1;
    padding: 0 15px;
    box-shadow: -2px 0 5px rgba(0,0,0,0.1);
    background-color: #f9f9f9;
    min-height: 80vh;
    display: flex;
    flex-direction: column;
  }
  /* Section pemilihan meja */
  .table-selection {
    margin-bottom: 20px;
  }
  /* New Order Section: input nomor meja dan tombol */
  .new-order-section {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
  }
  .new-order-section input {
    flex: 1;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  .btn-new-order {
    padding: 10px 15px;
    border: none;
    border-radius: 4px;
    background-color: #5e64ff;
    color: white;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .btn-new-order:hover {
    background-color: #455ecc;
  }
  /* Tampilan grid meja */
  .tables-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 10px;
    margin-top: 15px;
  }
  .table-button {
    padding: 10px;
    text-align: center;
    border: 1px solid #ddd;
    border-radius: 4px;
    cursor: pointer;
    background-color: #ffffff;
    transition: all 0.2s ease;
  }
  .table-button:hover {
    border-color: #8a8aff;
  }
  .table-button.selected {
    background-color: #5e64ff;
    color: white;
    font-weight: bold;
  }
  .table-button.occupied {
    background-color: #ff5858;
    color: white;
    opacity: 0.6;
    cursor: not-allowed;
  }
  
  /* Item selection */
  .item-categories {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 15px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
  }
  
  .category-button {
    padding: 8px 15px;
    border-radius: 20px;
    background-color: #f3f3f3;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .category-button:hover {
    background-color: #e0e0ff;
  }
  
  .category-button.active {
    background-color: #5e64ff;
    color: white;
  }

  .item-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    margin-top: 15px;
    overflow-y: auto;
    flex-grow: 1;
    padding-bottom: 15px;
  }
  
  .item-card {
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 10px;
    background-color: white;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    display: flex;
    flex-direction: column;
    height: 100px;
    justify-content: center;
  }
  
  .item-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .item-name {
    font-weight: 500;
    margin-bottom: 5px;
  }

  .item-price {
    color: #555;
    font-size: 0.9em;
  }

  .variant-badge {
    position: absolute;
    right: 5px;
    top: 5px;
    background-color: #ffd100;
    color: #333;
    font-size: 0.7em;
    padding: 2px 5px;
    border-radius: 3px;
  }
  
  /* Order summary */
  .order-header {
    margin-bottom: 20px;
  }

  .selected-table {
    font-size: 1.2em;
    font-weight: bold;
    margin-bottom: 10px;
  }

  .order-items {
    flex-grow: 1;
    overflow-y: auto;
    margin-bottom: 20px;
  }

  .order-item {
    padding: 10px;
    border-bottom: 1px solid #ddd;
    display: flex;
    align-items: center;
  }

  .order-item:last-child {
    border-bottom: none;
  }

  .item-info {
    flex-grow: 1;
  }

  .item-details {
    display: flex;
    justify-content: space-between;
  }

  .item-title {
    font-weight: 500;
  }

  .item-subtotal {
    text-align: right;
  }

  .item-notes {
    font-size: 0.8em;
    color: #666;
    margin-top: 3px;
  }

  .item-attributes {
    font-size: 0.85em;
    color: #444;
    font-style: italic;
    margin-top: 3px;
  }

  .quantity-control {
    display: flex;
    align-items: center;
    margin-left: 15px;
  }

  .qty-btn {
    width: 25px;
    height: 25px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background-color: #f3f3f3;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .qty-display {
    padding: 0 10px;
  }

  .remove-item {
    color: #ff5858;
    margin-left: 15px;
    cursor: pointer;
  }

  .status-badge {
    font-size: 0.8em;
    padding: 2px 6px;
    border-radius: 10px;
    margin-left: 10px;
  }

  .status-new {
    background-color: #ddd;
    color: #333;
  }

  .status-sent {
    background-color: #ffeb3b;
    color: #333;
  }

  .status-cooking {
    background-color: #ff9800;
    color: white;
  }

  .status-ready {
    background-color: #4caf50;
    color: white;
  }

  .status-served {
    background-color: #2196f3;
    color: white;
  }

  /* Order footer */
  .order-actions {
    border-top: 1px solid #ddd;
    padding-top: 15px;
  }

  .order-total {
    display: flex;
    justify-content: space-between;
    font-size: 1.2em;
    font-weight: bold;
    margin-bottom: 15px;
  }

  .action-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .action-btn {
    padding: 12px;
    border-radius: 4px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    text-align: center;
  }

  .btn-kitchen {
    background-color: #4caf50;
    color: white;
  }

  .btn-additional {
    background-color: #2196f3;
    color: white;
  }

  .btn-served {
    background-color: #ff9800;
    color: white;
  }

  .btn-print {
    background-color: #607d8b;
    color: white;
  }

  .disabled-btn {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* Variant selection modal */
  .modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0,0,0,0.5);
    z-index: 1000;
  }

  .variant-modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1001;
    width: 90%;
    max-width: 500px;
  }

  .modal-header {
    margin-bottom: 15px;
    font-size: 1.2em;
    font-weight: bold;
  }

  .variant-attributes {
    margin-bottom: 20px;
  }

  .attribute-group {
    margin-bottom: 15px;
  }

  .attribute-label {
    margin-bottom: 5px;
    font-weight: 500;
  }

  .attribute-select {
    width: 100%;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }

  .modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }

  .modal-btn {
    padding: 8px 15px;
    border-radius: 4px;
    border: none;
    cursor: pointer;
  }

  .btn-cancel {
    background-color: #f3f3f3;
  }

  .btn-add {
    background-color: #5e64ff;
    color: white;
  }

  /* Item notes modal */
  .notes-modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 1001;
    width: 90%;
    max-width: 500px;
  }

  .notes-textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    min-height: 100px;
    margin-bottom: 15px;
  }

  /* Loading indicator */
  .loading-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255,255,255,0.8);
    z-index: 2000;
    align-items: center;
    justify-content: center;
  }

  .spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #5e64ff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  .search-box {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-bottom: 15px;
  }

  /* Responsive design */
  @media (max-width: 768px) {
    .waiter-order-container {
      flex-direction: column;
    }

    .left-column, .right-column {
      width: 100%;
      min-height: unset;
    }

    .right-column {
      margin-top: 20px;
      box-shadow: none;
      border-top: 1px solid #ddd;
    }
  }
</style>
<div class="waiter-order-container">
  <!-- Left Column: Pilihan Meja & Menu Items -->
  <div class="left-column">
    <!-- Bagian Pemilihan Meja -->
    <div class="table-selection">
      <h3>Select Table for Edit Order</h3>
      
      <!-- New Order Section untuk tambah order baru -->
      <div class="new-order-section">
        <input type="text" id="new-order-table-number" placeholder="Enter Table Number" />
        <button id="new-order-btn" class="btn-new-order">New Order</button>
      </div>
      
      <!-- Grid Meja aktif (hanya yang sedang ada order aktif) -->
      <div class="tables-grid" id="tables-container">
        <div class="loading-message">Loading tables...</div>
      </div>
    </div>
    
    <!-- Bagian Pemilihan Menu Items -->
    <div class="items-selection">
      <h3>Select Items</h3>
      <input type="text" class="search-box" id="item-search" placeholder="Search items..." />
      <div class="item-categories" id="item-categories">
        <div class="category-button active" data-group="all">All</div>
        <!-- Kategori item ditampilkan secara dinamis -->
      </div>
      <div class="item-list" id="items-container">
        <div class="loading-message">Loading items...</div>
      </div>
    </div>
  </div>
  
  <!-- Right Column: Ringkasan Order -->
  <div class="right-column">
    <div class="order-header">
      <h3>Order Summary</h3>
      <div class="selected-table" id="selected-table-display">No table selected</div>
    </div>
    <div class="order-items" id="order-items-container">
      <div class="empty-order-message">No items added to order</div>
    </div>
    <div class="order-actions">
      <div class="order-total">
        <span>Total:</span>
        <span id="order-total-amount">₹0.00</span>
      </div>
      <div class="action-buttons">
        <button id="send-to-kitchen-btn" class="action-btn btn-kitchen disabled-btn">Send to Kitchen</button>
        <button id="send-additional-btn" class="action-btn btn-additional disabled-btn">Send Additional Items</button>
      </div>
    </div>
  </div>
</div>

<!-- Item Variant Modal -->
<div class="modal-overlay" id="modal-overlay"></div>
<div class="variant-modal" id="variant-modal">
  <div class="modal-header" id="variant-item-name">Select Options</div>
  <div class="variant-attributes" id="variant-attributes-container">
    <!-- Variant attributes will be displayed here -->
</div>
  <div class="modal-actions">
    <button id="cancel-variant-btn" class="modal-btn btn-cancel">Cancel</button>
    <button id="add-variant-btn" class="modal-btn btn-add">Add to Order</button>
  </div>
</div>

<!-- Item Notes Modal -->
<div class="notes-modal" id="notes-modal">
  <div class="modal-header">Add Special Instructions</div>
  <textarea id="item-notes" class="notes-textarea" placeholder="Enter special instructions or notes for this item..."></textarea>
  <div class="modal-actions">
    <button id="cancel-notes-btn" class="modal-btn btn-cancel">Cancel</button>
    <button id="save-notes-btn" class="modal-btn btn-add">Save</button>
  </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loading-overlay">
  <div class="spinner"></div>
</div>

<script>
  // This is where the page context data will be available
  window.waiterOrderData = {
    csrfToken: "{{ frappe.session.csrf_token }}",
  };
</script>

<div class="waiter-order-container">
  <!-- Left Column: Table Selection & Menu Items -->
  <div class="left-column">
    <!-- Table Selection Section -->
    <div class="table-selection">
      <h3>Select Table</h3>
      <div class="tables-grid" id="tables-container">
        <!-- Tables will be loaded dynamically -->
        <div class="loading-message">Loading tables...</div>
      </div>
    </div>
    
    <!-- Item Selection Section -->
    <div class="item-selection">
      <h3>Menu Items</h3>
      <input type="text" class="search-box" id="item-search" placeholder="Search items...">
      
      <div class="item-categories" id="item-categories">
        <!-- Categories will be loaded dynamically -->
      </div>
      
      <div class="item-list" id="item-list">
        <!-- Items will be loaded dynamically -->
        <div class="loading-message">Loading menu items...</div>
      </div>
    </div>
  </div>
  
  <!-- Right Column: Order Summary & Actions -->
  <div class="right-column">
    <div class="order-header">
      <h3>Order Summary</h3>
      <div class="selected-table" id="selected-table-display">
        No table selected
      </div>
    </div>
    
    <div class="order-items" id="order-items">
      <!-- Order items will be displayed here -->
      <div class="empty-order-message">No items added to order</div>
    </div>
    
    <div class="order-footer">
      <div class="order-total">
        <span>Total:</span>
        <span id="order-total-amount">₹0.00</span>
      </div>
      
      <div class="action-buttons">
        <button id="btn-send-kitchen" class="action-btn btn-kitchen disabled-btn">Send to Kitchen</button>
        <button id="btn-send-additional" class="action-btn btn-additional disabled-btn">Send Additional Items</button>
        <button id="btn-mark-served-all" class="action-btn btn-served disabled-btn">Mark All as Served</button>
        <button id="btn-print-order" class="action-btn btn-print disabled-btn">Print Order</button>
      </div>
    </div>
  </div>
</div>

<!-- Item Variant Selection Modal -->
<div class="modal-overlay" id="variant-overlay"></div>
<div class="variant-modal" id="variant-modal">
  <div class="modal-header" id="variant-modal-title">Select Variant Options</div>
  
  <div class="variant-attributes" id="variant-attributes">
    <!-- Variant attributes will be loaded dynamically -->
  </div>
  
  <div class="modal-actions">
    <button class="modal-btn btn-cancel" id="btn-cancel-variant">Cancel</button>
    <button class="modal-btn btn-add" id="btn-add-variant">Add to Order</button>
  </div>
</div>

<!-- Item Notes Modal -->
<div class="modal-overlay" id="notes-overlay"></div>
<div class="notes-modal" id="notes-modal">
  <div class="modal-header">Add Notes</div>
  
  <textarea class="notes-textarea" id="item-notes-textarea" placeholder="Add special instructions..."></textarea>
  
  <div class="modal-actions">
    <button class="modal-btn btn-cancel" id="btn-cancel-notes">Cancel</button>
    <button class="modal-btn btn-add" id="btn-save-notes">Save Notes</button>
  </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loading-overlay">
  <div class="spinner"></div>
</div>
{% endblock %}

{% block script %}
<script>
  window.waiterOrderData = {
    csrfToken: "{{ frappe.session.csrf_token }}"
  };
</script>

<script src="/assets/restaurant_management/js/waiter_order.js"></script>
{% endblock %}